# vhdl-playground
This repository is intended to be used as a simple VHDL syntax checker. It can also be used to run VHDL testbenches. This repository leverages the `surf` library (imported as a submodule) and uses `ghdl` to check the syntax and run the testbenches.

## How to Clone this Repository
Run: `$ git clone --recurse-submodules git@github.com:slaclab/vhdl-playground.git`

## Folder Structure
Under `shared/` one can find `rtl/` and `tb/`. If one wants to add new files to-be-checked in terms of syntax, these files have to be added under `rtl/`. If one wants to run a VHDL testbench, that testbench file has to be added under `tb/` first. Note that if one adds a file named `Test.vhd`, the testbench for that particular file has to be named `TestTb.vhd`.

Under `shared/`, one can also find `pkg/`. Add any VHDL package files here if needed.

Under `shared/`, one can also find `surf/` and `surf/pkg/`. *No* files should be added by the user here; these directories are populated by the `Makefile` located under `firmware/`. More information below.

## Makefile
The `Makefile` located under `firmware/` generates symbolic links of source files taken from `surf`. If the user wishes to add more `surf` files, they have to add the entries in `prepareSurf`. `make clean` cleans up the surf symbolic links and any files generated by `ghdl`.

## How to Run
1. Navigate to the `firmware/` directory, and run `make clean && make`. This will create symbolic links from the `surf` library (located under `submodules/`) into the `shared/rtl/surf` and `shared/rtl/surf/pkg` directories.
2. Navigate to the `firmware/ghdl/` directory. There are two options here:
    1.  Run `$ bash ghdlRun.sh` to *only* run syntax checking on the VHDL files.
    2. If one wants to run a testbench, they need to run `$ bash ghdlRun.sh ${TB_NAME}`, where `${TB_NAME}` should be the name of the testbench file that should be run. Example: run `$ bash ghdlRun.sh AppTb` to run the simple testbench already provided

## Prerequisites
* `ghdl-llvm` (`ghdl` or `ghdl-gcc` can also be used, but the `${GHDL_CMD}` under `firmware/ghdl/ghdlRun.sh` needs to reflect that. A custom `ghdl` installation executable can also be used)
* `gtkwave`